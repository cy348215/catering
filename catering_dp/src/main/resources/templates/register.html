<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>店铺注册</title>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/gloab.css" rel="stylesheet">
<link href="css/index.css" rel="stylesheet">
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/register.js"></script>
</head>
<body class="bgf4">
<div class="login-box f-mt10 f-pb50">
	<div class="main bgf">    
    	<div class="reg-box-pan display-inline">  
        	<div class="step">        	
                <ul>
                    <li class="col-xs-4 on">
                        <span class="num"><em class="f-r5"></em><i>1</i></span>                	
                        <span class="line_bg lbg-r"></span>
                        <p class="lbg-txt">填写账户信息</p>
                    </li>
                    <li class="col-xs-4">
                        <span class="num"><em class="f-r5"></em><i>2</i></span>
                        <span class="line_bg lbg-l"></span>
                        <span class="line_bg lbg-r"></span>
                        <p class="lbg-txt">验证账户信息</p>
                    </li>
                    <li class="col-xs-4">
                        <span class="num"><em class="f-r5"></em><i>3</i></span>
                        <span class="line_bg lbg-l"></span>
                        <p class="lbg-txt">注册成功</p>
                    </li>
                </ul>
            </div>
        	<div class="reg-box" id="verifyCheck" style="margin-top:20px;">
            	<div class="part1">                	
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>店铺名称：</span>
                        <div class="f-fl item-ifo">
                            <input  type="text" maxlength="20" class="txt03 f-r3 required" tabindex="1" data-valid="isNonEmpty||between:3-20||isUname" data-error="店铺名称不能为空||店铺名称长度3-20位||只能输入中文、字母、数字、下划线，且以中文或字母开头" id="storename" />                            <span class="ie8 icon-close close hide"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus"><span id="sp1">3-20位，中文、字母、数字、下划线的组合，以中文或字母开头</span></label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>店铺类型：</span>
                        <div class="f-fl item-ifo">
                            <select style="text-align: center;height: 36px;" type="text" maxlength="20" class="txt03 f-r3 required" tabindex="1" id="storetype" />
                                <option>--请选择--</option>
                            </select>
                            <label class="focus">请选择您的店铺类型</label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>店铺负责人：</span>
                        <div class="f-fl item-ifo">
                            <input type="text" maxlength="10" class="txt03 f-r3 required" tabindex="1" data-valid="isNonEmpty||between:2-10||isZh" data-error="真实姓名不能为空||真实姓名长度2-10位||只能输入中文" id="storemaster" />                        <span class="ie8 icon-close close hide"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus"><span>请输入负责人姓名</span></label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>营业执照编号：</span>
                        <div class="f-fl item-ifo">
                            <input  type="text" maxlength="20" class="txt03 f-r3 required" tabindex="1" data-valid="isNonEmpty||between:13||isUname" data-error="营业执照编号不能为空||营业执照编号长度13位||只能输入字母、数字、下划线" id="storemember" />                            <span class="ie8 icon-close close hide"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus" id="sp2"><span>13位，字母、数字、下划线的组合，以数字或字母开头</span></label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>联系电话：</span>
                        <div class="f-fl item-ifo">
                            <input type="text" class="txt03 f-r3 required" keycodes="tel" tabindex="2" data-valid="isNonEmpty||isPhone" data-error="手机号码不能为空||手机号码格式不正确" maxlength="11" id="phone" /> 
                            <span class="ie8 icon-close close hide"></span>                           
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus" id="sp3">请填写11位有效的手机号码</label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>所在省：</span>
                        <div class="f-fl item-ifo">
                            <select style="text-align: center;height: 36px;" type="text" maxlength="20" class="txt03 f-r3 required" tabindex="1" id="storesheng" />
                            <option>--请选择所在省份--</option>
                            </select>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>所在市：</span>
                        <div class="f-fl item-ifo">
                            <select style="text-align: center;height: 36px;" type="text" maxlength="20" class="txt03 f-r3 required" tabindex="1" id="storeshi" />
                            <option>--请选择所在城市--</option>
                            </select>
                            <label class="focus"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>详细地址：</span>
                        <div class="f-fl item-ifo">
                            <input type="text" class="txt03 f-r3 required" tabindex="2" id="adress"  data-valid="isNonEmpty" data-error="地址不能为空"/>
                            <span class="ie8 icon-close close hide"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus">请输入店铺详细地址</label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>邮箱地址：</span>
                        <div class="f-fl item-ifo">
                            <input type="text" class="txt03 f-r3 required" tabindex="2" id="email" data-valid="isNonEmpty" data-error="邮箱地址不能为空"/>
                            <span class="ie8 icon-close close hide"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus" id="sp4">请输入您的邮箱地址</label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>密码：</span>    
                        <div class="f-fl item-ifo">
                            <input type="password" id="password" maxlength="20" class="txt03 f-r3 required" tabindex="3" style="ime-mode:disabled;" onpaste="return  false" autocomplete="off" data-valid="isNonEmpty||between:6-20||level:2" data-error="密码不能为空||密码长度6-20位||该密码太简单，有被盗风险，建议字母+数字的组合" /> 
                            <span class="ie8 icon-close close hide" style="right:55px"></span>
                            <span class="showpwd" data-eye="password"></span>                        
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus">6-20位英文（区分大小写）、数字、字符的组合</label>
                            <label class="focus valid"></label>
                            <span class="clearfix"></span>
                            <label class="strength">
                            	<span class="f-fl f-size12">安全程度：</span>
                            	<b><i>弱</i><i>中</i><i>强</i></b>
                            </label>    
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>确认密码：</span>    
                        <div class="f-fl item-ifo">
                            <input type="password" maxlength="20" class="txt03 f-r3 required" tabindex="4" style="ime-mode:disabled;" onpaste="return  false" autocomplete="off" data-valid="isNonEmpty||between:6-16||isRepeat:password" data-error="密码不能为空||密码长度6-16位||两次密码输入不一致" id="rePassword" />
                            <span class="ie8 icon-close close hide" style="right:55px"></span>
                            <span class="showpwd" data-eye="rePassword"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus">请再输入一遍上面的密码</label> 
                            <label class="focus valid"></label>                          
                        </div>
                    </div>
                    <div class="item col-xs-12" style="height:auto">
                        <span class="intelligent-label f-fl">&nbsp;</span>  
                        <p class="f-size14 required"  data-valid="isChecked" data-error="请先同意条款"> 
                        	<input type="checkbox" checked /><a href="javascript:showoutc();" class="f-ml5">我已阅读并同意条款</a>
                        </p>                       
                        <label class="focus valid"></label> 
                    </div> 
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl">&nbsp;</span>    
                        <div class="f-fl item-ifo">
                           <a href="javascript:;" class="btn btn-blue f-r3" id="btn_part1">下一步</a>                         
                        </div>
                    </div> 
                </div>
                <div class="part2" style="display:none">
                	<div class="alert alert-info" style="width:700px">验证码已发送到您的邮箱，请输入验证码，确保您的邮箱地址真实有效。</div>
                    <div class="item col-xs-12 f-mb10" style="height:auto">
                        <span class="intelligent-label f-fl">邮箱地址：</span>
                        <div id="phone1" class="f-fl item-ifo c-blue">

                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>验证码：</span>    
                        <div class="f-fl item-ifo">
                            <input type="text" maxlength="6" id="verifyNo" class="txt03 f-r3 f-fl required" tabindex="4" style="width:167px" data-valid="isNonEmpty||isInt" data-error="验证码不能为空||请输入6位数字验证码" /> 
                           	<span class="btn btn-gray f-r3 f-ml5 f-size13" id="time_box" disabled style="width:97px;display:none;">发送验证码</span>
                            <span class="btn btn-gray f-r3 f-ml5 f-size13" id="verifyYz" style="width:97px;">发送验证码</span>
                            <span class="ie8 icon-close close hide" style="right:130px"></span>
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus"><span>请查收邮箱信息，并填写信息的验证码（此验证码3分钟内有效）</span></label>
                            <label class="focus valid"></label>                        
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl">&nbsp;</span>    
                        <div class="f-fl item-ifo">
                           <a href="javascript:;" class="btn btn-blue f-r3" id="btn_part2">注册</a>                         
                        </div>
                    </div> 
                </div>
                <div class="part3" style="display:none">
                	<div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>真实姓名：</span>    
                        <div class="f-fl item-ifo">
                            <input type="text" maxlength="10" class="txt03 f-r3 required" tabindex="1" data-valid="isNonEmpty||between:2-10||isZh" data-error="真实姓名不能为空||真实姓名长度2-10位||只能输入中文" id="adminNo" />   
                            <span class="ie8 icon-close close hide"></span>                         
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus">请再次输入负责人姓名</label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl"><b class="ftx04">*</b>身份证号：</span>    
                        <div class="f-fl item-ifo">
                            <input type="text" class="txt03 f-r3 required" tabindex="2" data-valid="isNonEmpty||isCard" data-error="身份证号不能为空||身份证号码格式不正确" maxlength="18" id="memberid" />
                            <span class="ie8 icon-close close hide"></span>                        
                            <label class="icon-sucessfill blank hide"></label>
                            <label class="focus">请填写18位有效的身份证号码</label>
                            <label class="focus valid"></label>
                        </div>
                    </div>
                    <div class="item col-xs-12">
                        <span class="intelligent-label f-fl">&nbsp;</span>    
                        <div class="f-fl item-ifo">
                           <a href="javascript:;" class="btn btn-blue f-r3" id="btn_part3">下一步</a>                         
                        </div>
                    </div>
                </div>  
                <div class="part4 text-center" style="display:none">
                	<h3>您的注册信息已经提交，请关注您的邮箱，我们会将结果发送至您的邮箱！</h3>
                    <p class="c-666 f-mt30 f-mb50">页面将在 <strong id="times" class="f-size18">10</strong> 秒钟后，跳转到 <a href="register" class="c-blue">注册中心</a></p>
                </div>          
            </div>
        </div>
    </div>
</div>
<div class="m-sPopBg" style="z-index:998;"></div>
<div class="m-sPopCon regcon">
	<div class="m-sPopTitle"><strong>服务协议条款</strong><b id="sPopClose" class="m-sPopClose" onClick="closeClause()">×</b></div>
    <div class="apply_up_content">
    	<pre class="f-r0">
		<strong>同意以下服务条款，提交注册信息</strong>
        </pre>
    </div>
    <center><a class="btn btn-blue btn-lg f-size12 b-b0 b-l0 b-t0 b-r0 f-pl50 f-pr50 f-r3" href="javascript:closeClause();">已阅读并同意此条款</a></center>
</div>
<script>
$(function(){
    var code = "";
    var email = "";
    var storemaster = "";
    var storename = "";
    var storetype = "";
    var storemember = "";
    var phone = "";
    var storesheng = "";
    var storeshi = "";
    var adress = "";
    var password = "";
        //第一页的确定按钮
	$("#btn_part1").click(function(){
	    storename = $("#storename").val();//店铺名称
        storetype = $("#storetype").val();//店铺类型
	    storemaster = $("#storemaster").val();//店铺负责人
        storemember = $("#storemember").val();//经营许可号
	    phone = $("#phone").val();//电话号
	    storesheng = $("#storesheng").val();//所在省
	    storeshi = $("#storeshi").val();//所在市
	    adress = $("#adress").val();//详细地址
	    email = $("#email").val();//邮箱
	    password = $("#password");//密码
        $.post("checkstorename",{"storename":storename},function (data1) {
            if (data1 == true){
                $.post("checkstoremember",{"storemember":storemember},function (data2){
                    if (data2 == true){
                        $.post("checkphone",{"phone":phone},function (data3) {
                            if (data3 == true){
                                $.post("checkemail",{"email":email},function (data4) {
                                    if (data4 == true){
                                        //if(!verifyCheck._click()) return;
                                        $(".part1").hide();
                                        $(".part2").show();
                                        $(".step li").eq(1).addClass("on");
                                        var phon = $("<font>"+email+"</font>");
                                        $("#phone1").append(phon);

                                    } else {
                                        $("#sp4").empty();
                                        var ss = $("<font>此邮箱已被使用</font>")
                                        $("#sp4").append(ss);
                                        $("#email").val("");
                                    }
                                });
                            } else {
                                $("#sp3").empty();
                                var ss = $("<font>此手机号已被使用</font>")
                                $("#sp3").append(ss);
                                $("#phone").val("");
                            }
                        });
                    } else {
                        $("#sp2").empty();
                        var ss = $("<font>此编号已被使用</font>")
                        $("#sp2").append(ss);
                        $("#storemember").val("");
                    }
                });
            } else {

                $("#sp1").empty();
                var ss = $("<font>此名称已被使用</font>")
                $("#sp1").append(ss);
                $("#storename").val("");
            }
        });
	});
    var maxTime = 60;
    function countDown() {
        if (maxTime == 0){
            code = ""
        }else {
            maxTime--;
            setTimeout(countDown,1000);
        }
    }
	//法送验证码
    $("#verifyYz").click(function () {
        $.post("sendCode",{"email":email},function (data) {
            code = data;
            alert("发送成功");
            countDown();
        });
    });
	//第二页的确定按钮
	$("#btn_part2").click(function(){
        if (code == $("#verifyNo").val()) {
            //if (!verifyCheck._click()) return;
            $(".part2").hide();
            $(".part3").show();
        } else {
            alert("验证码有误");
            $("#verifyNo").val("");
        }
	});	
	//第三页的确定按钮
    var memberid = "";
	$("#btn_part3").click(function(){
	    alert("part3");
	    if (storemaster == $("#adminNo").val()){
	        alert("part33333");
	        memberid = $("#memberid").val();
            storename = $("#storename").val();//店铺名称
            storetype = $("#storetype").val();//店铺类型
            storemaster = $("#storemaster").val();//店铺负责人
            storemember = $("#storemember").val();//经营许可号
            phone = $("#phone").val();//电话号
            storesheng = $("#storesheng").val();//所在省
            storeshi = $("#storeshi").val();//所在市
            adress = $("#adress").val();//详细地址
            email = $("#email").val();//邮箱
            password = $("#password").val();//密码
            $.post("savestore",{"storename":storename,
                "storetype":storetype, "storemaster":storemaster,
                "storemember":storemember,"phone":phone,
                "storesheng":storesheng,"storeshi":storeshi,
                "adress":adress,"email":email,"password":password,"memberid":memberid
            },function (data) {
                if (data == true){
                    //if(!verifyCheck._click()) return;
                    $(".part3").hide();
                    $(".part4").show();
                    $(".step li").eq(2).addClass("on");
                    countdown({
                        maxTime:10,
                        ing:function(c){
                            $("#times").text(c);
                        },
                        after:function(){
                            window.location.href="register";
                        }
                    });
                } else {
                    alert("注册失败");
                }
            })
        } else {
	        alert("两次输入的名称不一致");
            $("#adminNo").val("");
        }

	});
	$.post("getTag",function (data) {
        for (var i = 0; i < data.length; i++) {
            var op = $("<option>"+data[i].name+"</option>");
            $("#storetype").append(op);
        }
    });
	$.post("getCity",function (data) {
        for (var i = 0; i < data.length; i++) {
            if (data[i].type == 1){
                var op = $("<option>"+data[i].cityname+"</option>");
                $("#storesheng").append(op);
            }
        }
    })
    $("#storesheng").blur(function () {
        var name = $("#storesheng").val();
        if (name.length == 0){

        } else {
            $.post("getCityId", {"name": name}, function (id) {
                $.post("getCity", function (data) {
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].pid == id) {
                            var op = $("<option>" + data[i].cityname + "</option>");
                            $("#storeshi").append(op);
                        }
                    }
                })
            })
        }
    });
});
function showoutc(){$(".m-sPopBg,.m-sPopCon").show();}
function closeClause(){
	$(".m-sPopBg,.m-sPopCon").hide();		
}
</script>
<div style="text-align:center;">
</div>
</body>
</html>
